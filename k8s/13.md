# Lab 13

## Task 1 verification

`minikube kubectl -- get statefulset web-app`:

```shell
NAME      READY   AGE
web-app   1/1     2m25s
```

## Task 2

### Implementation

`minikube -- kubectl get po,sts,svc,pvc`:

```shell
NAME                                       READY   STATUS    RESTARTS      AGE
pod/vault-0                                1/1     Running   3 (37m ago)   14d
pod/vault-agent-injector-dbfc5cd77-jx2w2   1/1     Running   3 (37m ago)   14d
pod/web-app-0                              1/1     Running   0             19s
pod/web-app-1                              1/1     Running   0             14s
pod/web-app-2                              1/1     Running   0             7s

NAME                       READY   AGE
statefulset.apps/vault     1/1     14d
statefulset.apps/web-app   3/3     19s

NAME                               TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)             AGE
service/kubernetes                 ClusterIP   10.96.0.1        <none>        443/TCP             28d
service/vault                      ClusterIP   10.101.231.178   <none>        8200/TCP,8201/TCP   14d
service/vault-agent-injector-svc   ClusterIP   10.109.243.250   <none>        443/TCP             14d
service/vault-internal             ClusterIP   None             <none>        8200/TCP,8201/TCP   14d
service/web-app                    ClusterIP   10.103.180.53    <none>        80/TCP              19s

NAME                                  STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
persistentvolumeclaim/www-web-app-0   Bound    pvc-ed528780-2e67-4787-abcb-9fb1d83262a6   1Gi        RWO            standard       25m
persistentvolumeclaim/www-web-app-1   Bound    pvc-62b951a9-44ac-4a18-9014-f85f1d729e42   1Gi        RWO            standard       14s
persistentvolumeclaim/www-web-app-2   Bound    pvc-11cecba2-d5d5-4386-b5f2-cfab5597285c   1Gi        RWO            standard       7s
```

I visit endpoint four times via `minikube service web-app`.

Afterwards, do `minikube kubectl -- exec pod/web-app-0 -- cat data/visits`:

```shell
cat: can't open 'data/visits': No such file or directory
command terminated with exit code 1
```

do `minikube kubectl -- exec pod/web-app-1 -- cat data/visits`:

```shell
cat: can't open 'data/visits': No such file or directory
command terminated with exit code 1
```

do `minikube kubectl -- exec pod/web-app-2 -- cat data/visits`:

```shell
4
```

### Explanation

This is because each statefulset has their own state, so by visiting one of the pods' endpoints, I changed only state of
one pod.


